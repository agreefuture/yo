// object

use "std/string";
use "std/number";

// every custom type you declare implicitly conforms to the `Object` protocol

#[base_protocol]
protocol Object {
    fn hashValue(self: Self): int {
        ret self as int;
    }

    fn description(self: Self): String {
        // TODO use the proper runtime::typeof instead
        val metatype = runtime::typeof(self);
        //ret metatype.name;
        ret String::format("<%s %nh>", [metatype.name, @(self as int)]);
    }

    fn isEqualTo(self: Self, other: Self): bool {
        if self == other {
            ret true;
        }
        ret false;
    }
}


impl Object {
    static fn description(obj: id): String {
        val metatype = runtime::typeof(obj);
        val description_fn_ptr = metatype.vtable.description as fn<(id): String>;
        ret description_fn_ptr(obj);
    }
}
