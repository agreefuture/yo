// object

use "std/string";
use "std/number";

// every custom type you declare implicitly conforms to the `Object` protocol

#[base_protocol]
protocol Object {
    fn hashValue(self: Self): int {
        return self as int;
    }

    fn description(self: Self): String {
        return Object::_description(self);
    }

    fn debugDescription(self: Self): String {
        return self.description();
    }

    fn isEqualTo(self: Self, other: Self): bool {
        if self == other {
            return true;
        }
        return false;
    }
}


impl Object {
    // Call some object's `description` method
    static unsafe fn description(obj: id): String {
        return obj.description();
    }

    // The default implementation of -[id description]
    static fn _description(obj: id): String {
        let metatype = runtime::typeof(obj);
        return String::format("<%s %nh>", metatype.name, @(obj as int));
    }

    static unsafe fn _isEqualTo(obj1: id, obj2: id): bool {
        return obj1.isEqualTo(obj2) as bool;
    }
}
